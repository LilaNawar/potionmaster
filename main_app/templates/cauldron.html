{%extends 'base.html'%} {% block content %} {% load static %}
<head>
  <link
    rel="stylesheet"
    type="text/css"
    href="{% static 'css/cauldron.css' %}"
  />
  <link
    href="https://fonts.googleapis.com/icon?family=Material+Icons"
    rel="stylesheet"
  />
</head>
  <div id="body-content">
    <br /><br />
    <div id="top-row-wrapper">
      <div id="profile-container">
        <div id="dropdown-container">
          <img
            src="https://api-private.atlassian.com/users/2dff6b099a5ac2f4baab1bb770899247/avatar"
            id="profile-icon"
          />

          <div id="dropDownMenu">
            {{user.username}}
            <a href="#">My Profile</a>
            <a href="{% url 'potion_index' %}">My Potions</a>
            <a href="{% url 'ingredient_index' %}">My Ingredients</a>
          </div>
        </div>
      </div>
      <div id="cauldron-container">
        <h2><span class="sparkle">POTION NAME</span></h2>
        <img src="https://i.imgur.com/SJx8DwX.png" class="cauldron-image" />
      </div>
      <div id="recipe-container">
        <div>
          <h4>Recipe</h4>
          <table>
            <tr>
              <td>Quant.</td>
              <td>Ingredient</td>
            </tr>
            <tr>
              <td>Quant.</td>
              <td>Ingredient</td>
            </tr>
            <tr>
              <td>Quant.</td>
              <td>Ingredient</td>
            </tr>
          </table>
        </div>
        <br />
        <a href="#" id="concoctBtn" class="btn">Concoct</a>
      </div>
    </div>
    <h3>Ingredients</h3>
    <div id="bottom-row-wrapper">
      <div id="empty-container"></div>
      <div id="ingredients-container">
        <input value="{{ingredients}}" type="hidden" name="ingredients" id="ingredient-storage">
        <div class="arrow">
          <button class="btn" style="background-color: #7a6cd6" id="btnLeft">
            <i class="material-icons">arrow_back</i>
          </button>
        </div>
        <div id="ingredient-1" class="ingredient btn">
          <h5>Money</h5>
        </div>
        <div id="ingredient-2" class="ingredient btn">
          <h5>Happiness</h5>
        </div>
        <div id="ingredient-3" class="ingredient btn">
          <h5>Disease</h5>
        </div>
        <div class="arrow">
          <button class="btn" style="background-color: #7a6cd6" id="btnRight">
            <i class="material-icons">arrow_forward</i>
          </button>
        </div>
      </div>
      <div id="add-ingredient-container">
        <div class="ingredient">
          <a id="add-ingredient" href="{%url 'ingredient_create'%}" class="btn" style="color: black">
            <i class="material-icons" id="ctrl-point-icon">control_point</i>
          </a>
        </div>
      </div>
    </div>
  </div>
  <script>
    //User profile hover menu
    let profileIcon = document.getElementById("profile-icon");
    let dropdownContainer = document.getElementById("dropdown-container");
    let dropDownMenu = document.getElementById("dropDownMenu");
    profileIcon.addEventListener("mouseenter", showDropdown);
    dropdownContainer.addEventListener("mouseleave", showDropdown);

    function showDropdown(ev) {
      if (dropDownMenu.style.display === "flex") {
        dropDownMenu.style.display = "none";
      } else {
        dropDownMenu.style.display = "flex";
      }
    }

    //Scroll through ingredients list
    let leftBtn = document.getElementById("btnLeft");
    let rightBtn = document.getElementById("btnRight");
    leftBtn.addEventListener("click", scrollLeft);
    rightBtn.addEventListener("click", scrollRight);

    let ingredients_raw = document.getElementById("ingredient-storage").value;
    let i1 = document.getElementById("ingredient-1");
    let i2 = document.getElementById("ingredient-2");
    let i3 = document.getElementById("ingredient-3");


    console.log(ingredients_raw)
    console.log(typeof ingredients_raw)

    let ingredients_fullList = [];
    i_split=ingredients_raw.split(",");
    for (i_str of i_split) {
      str_split=i_str.split(": ");
      for (i2_str of str_split) {
        i2_str = i2_str.replace("'","");
        i2_str = i2_str.replace("'","");
        i2_str = i2_str.replace("[","");
        i2_str = i2_str.replace("{","");
        i2_str = i2_str.replace("}","");
        i2_str = i2_str.replace("]","");
        i2_str = i2_str.trim();
        ingredients_fullList.push(i2_str) ;
      }
    }

    // let ingredients = JSON.parse(ingredients_raw)
    console.log(ingredients_fullList)

    let counter = 0
    let new_obj = {}
    let ingredients = [];
    for (i = 0; i<ingredients_fullList.length; i+=2) {

      if (ingredients_fullList[i] === ingredients_fullList[0]) {
        ingredients.push(new_obj)
      }
      // new_obj= {
      //   ingredients_fullList[i]: ingredients_fullList[i+1]
      // }
    }
    console.log(counter)

    // let ingredients_arr = ingredients.split(',')
    // for (ingredient of ingredients_arr) {
    //   console.log(ingredient)
      
    //   console.log(JSON.parse(ingredient))
    // }

    

    function scrollLeft(ev) {
      console.log('hi')
    }

    function scrollRight(ev) {
      console.log('bye')
    }





  </script>


  {%endblock%}
</body>
